---
title: "Stat 537: Homework 3"
author: "Brandon Fenton and Kenny Flagg"
date: "Due Friday, Feb 5 at end of day"
output: html_document
---

1. _Summarize the missing data patterns. How many of each kind are present? Ignoring the name of the institutions, how many totals cells are missing out of the N=297 by Q=8 matrix of information?_

```{r p1_a, echo=F, comment="", message=F, warning=F}
require(pander)
require(mice)

#cc2010 <- read.csv("https://montana.box.com/shared/static/hlv178y436vggzmsxxzsdkoarfkopkvp.csv", header = TRUE)
#cc2010_PhD <- cc2010[(cc2010$BASIC2010>14 & cc2010$BASIC2010 < 18),]
#cc2010_PhD$BASIC2010 <- factor(cc2010_PhD$BASIC2010)
#cc2010Ps <- cc2010_PhD[,c("NAME", "BASIC2010", "FACFTTOT", "HUM_D", "PROF_D", "SOC_D", "STEM_D", "RESSTAFF", "STEM_EXP")]
#save(cc2010Ps, file = "cc2010Ps.RData")
load("cc2010Ps.RData")

cc2010.md <- md.pattern(cc2010Ps)
pander(cc2010.md, split.table = Inf)
```

There are 248 institutions with no missing cells. 48 institutions are missing the number of full-time faculty, number of non-faculty research staff, and amount of STEM research expense. One institution is missing all variables except for the 2010 Basic Classification. In total, 151 of the 2376 cells are missing.

2. _Make a tableplot of the data set cc2010Ps except the university names. It should be sorted based on the classification codes that Carnegie created. Describe the differences in the responses based on the tableplot results._

```{r p2_a, echo=F, comment=NA, message=F, warning=F, out.width="\\linewidth", out.height="0.3\\linewidth", fig.width=12, fig.height=4}
require(tabplot)

# Name is first column, BASIC2010 is first of remaining columns
tableplot(cc2010Ps[-1], sortCol = 1, nBins = 297)
```

Institutions with classification 15 tend to have higher numbers of faculty members and research staff, award more doctoral degrees, and spend more on STEM research than institutions with classifications 16 and 17. All of the institutions with missing responses have classification 17.

3. _Now consider re-sorting the observations based on other variables. You can use itableplot() or just re-sort manually using the sortCol= in the function call. For example, try sortCol=2 to sort based on total number of faculty. What does this show you about the missing observations? Does this support a MCAR assumption? Just use the plot to provide a short discussion._

```{r p3_a, echo=F, comment=NA, message=F, warning=F, out.width="\\linewidth", out.height="0.3\\linewidth", fig.width=12, fig.height=4}
tableplot(cc2010Ps[-1], sortCol = 1, nBins = 297)
```

4. _Before proceeding further, clean out any universities that have any missing values in this data set. Remake a tableplot that is sorted based on one of the quantitative variables._

5. _Make two parallel coordinate plots, one using matplot and one using parallelplot from lattice. In each, color the lines based on the BASIC2010 variable. I like to leave the coloring categorical variable in PCP plots which often alleviates the need to add a legend especially with an ordered categorical variable (if you know what direction it went). Make sure in each that I can read all the variable names in the versions you submit._

6. _The actual Carnegie rankings are based on initially ranking each quantitative variable to spread out the differences at small values and decrease the impacts of outliers. Use the rank function to generate a new data set that replaces the ranks on each of the quantitative variables. Remake your favorite PCP plot and discuss how different the classifications look in this plot._

7. _Find Montana State in the data set and highlight its observation in one of your PCP plots, making plots of the ranked and the original version of the data set. I like to create color and line width id vectors to pass to col and lwd to enhance the plot with other information when I want to change the color or line width for just an observation or two but you are welcome to tackle this in other ways (matplot allows a second plot to be added using add=T in the second plot call). Keep the basic three color groups and try to make MSU identifiable. Characterize MSU relative to the other institutions on these variables._


## R Code Appendix:
Problem 1:

Problem 3:

Problem 4:

Problem 5:

Problem 6:

Problem 7:


### About This Markdown File

  * File creation date: `r Sys.Date()`
  * `r R.version.string`
  * R version (short form): `r getRversion()`
  * Additional session information
  
```{r echo=FALSE}
sessionInfo()  # could use devtools::session_info() if you prefer that
```
